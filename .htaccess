# Security and performance
Options -Indexes
FileETag None
<IfModule mod_headers.c>
	Header unset ETag
	Header set X-Content-Type-Options "nosniff"
	Header set X-Frame-Options "DENY"
	Header set Referrer-Policy "no-referrer"
	Header set Permissions-Policy "accelerometer=(), ambient-light-sensor=(), autoplay=(), battery=(), camera=(), display-capture=(), document-domain=(), encrypted-media=(), fullscreen=(self), geolocation=(), gyroscope=(), magnetometer=(), microphone=(), midi=(), payment=(), picture-in-picture=(self), publickey-credentials-get=(), sync-xhr=(), usb=(), wake-lock=(), xr-spatial-tracking=()"
	Header set Cross-Origin-Resource-Policy "same-origin"
	Header set Cross-Origin-Opener-Policy "same-origin"
	Header set Cross-Origin-Embedder-Policy "require-corp"
	# CSP geral; ajuste origens externas se necess√°rio
	Header set Content-Security-Policy "default-src 'self'; base-uri 'self'; form-action 'self'; frame-ancestors 'none'; object-src 'none'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: https:; font-src 'self' data: https://cdnjs.cloudflare.com; connect-src 'self'; media-src 'self'"
</IfModule>

# Reduce server signature exposure
ServerSignature Off

# Increase upload limits for this application only
<IfModule mod_php.c>
	php_value upload_max_filesize 64M
	php_value post_max_size 64M
	php_value memory_limit 256M
	php_value max_file_uploads 60
	php_value max_input_time 300
	php_value max_execution_time 300
</IfModule>

# Allow serving modern image types
AddType image/avif .avif
AddType image/webp .webp
AddType image/svg+xml .svg

# Block access to sensitive files everywhere
<FilesMatch ".*\.(env|ini|log|sql|sqlite|conf|bak|swp|git|htpasswd|htaccess)$">
	Require all denied
</FilesMatch>

# Deny executing PHP in uploads (defense in depth) via FilesMatch
<FilesMatch "^uploads/.+\.(php|phtml|php5|phar|phps)$">
	Require all denied
</FilesMatch>

# Compression
<IfModule mod_deflate.c>
	AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript application/json image/svg+xml
</IfModule>
