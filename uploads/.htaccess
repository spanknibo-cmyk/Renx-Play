# Deny script execution in uploads
<IfModule mod_mime.c>
	RemoveHandler .php .php3 .php4 .php5 .php7 .php8 .phtml .phar
	RemoveType .php .php3 .php4 .php5 .php7 .php8 .phtml .phar
</IfModule>
<IfModule mod_php.c>
	php_flag engine off
</IfModule>
<IfModule mod_rewrite.c>
	RewriteEngine On
	RewriteRule ^.*\.(php[0-9]?|phtml|phar)$ - [F,L]
</IfModule>

# Only allow safe methods
<LimitExcept GET HEAD>
	Require all denied
</LimitExcept>

# Block listing
Options -Indexes

# Force download for potentially dangerous but allowed types
<IfModule mod_headers.c>
	Header set X-Content-Type-Options "nosniff"
</IfModule>
AddType application/octet-stream .svg .xml .json

# Cache control for static uploads
<IfModule mod_expires.c>
	ExpiresActive On
	ExpiresByType image/jpg "access plus 1 month"
	ExpiresByType image/jpeg "access plus 1 month"
	ExpiresByType image/gif "access plus 1 month"
	ExpiresByType image/png "access plus 1 month"
	ExpiresByType image/webp "access plus 1 month"
	ExpiresByType image/avif "access plus 1 month"
	ExpiresByType image/svg+xml "access plus 1 month"
</IfModule>
